steps:
  - task: UseDotNet@2
    displayName: Install .NET 3.1.x
    inputs:
      packageType: sdk
      version: 3.1.x

  - script: dotnet tool update -g dotnet-vs
    displayName: Install dotnet-vs tool

  - pwsh: echo "##vso[task.setvariable variable=MSB]$(vs where preview --prop=InstallationPath)"
    displayName: Update MSB Variable

  - script: vs install preview --quiet +Microsoft.VisualStudio.Component.ManagedDesktop.Core +core +desktop +azure +mobile
    displayName: Install VS Preview
    condition: eq(variables['MSB'], '')

  - pwsh: echo "##vso[task.prependpath]$(vs where preview --prop=InstallationPath)\MSBuild\Current\Bin"
    displayName: Update installation path
